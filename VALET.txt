Running VALET for misassembly detection...
find: ‘’: No such file or directory
###########################################################################
PROCESSING ASSEMBLY: asm_0 (/mnt/data/lj752/data/MSc_training/scripting/data_output/medaka/consensus.fasta)
###########################################################################
---------------------------------------------------------------------------
STEP:	 FILTERING ASSEMBLY CONTIGS LESS THAN 1000 BPs
RESULTS:	 /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/filtered_assembly.fasta
---------------------------------------------------------------------------
STEP:	 ALIGNING READS
COMMAND:	 bowtie2-build /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/filtered_assembly.fasta /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/indexes/temp_lhn_wvrj
COMMAND:	 bowtie2 -a -x /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/indexes/temp_lhn_wvrj -q -U /mnt/data/lj752/data/MSc_training/scripting/fastq_1.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_2.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_4.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_3.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_0.fastq --very-sensitive -a --reorder -p 8 --un /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/unaligned_reads/unaligned.reads -S /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/sam/library.sam
---------------------------------------------------------------------------
STEP:	 RUNNING SAMTOOLS
COMMAND:	 samtools view -F 0x100 -bS /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/sam/library.sam
COMMAND:	 samtools sort -@ 16 -o /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/bam/sorted_library.bam /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/bam/library.bam
COMMAND:	 samtools mpileup -C50 -A -f /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/filtered_assembly.fasta /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/bam/sorted_library.bam
RESULTS:	 /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/coverage/mpileup_output.out
COMMAND:	 samtools index /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/bam/sorted_library.bam
---------------------------------------------------------------------------
STEP:	 CALCULATING CONTIG COVERAGE
RESULTS:	 /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/coverage/temp.cvg
TypeError: '>' not supported between instances of 'str' and 'int'
VALET analysis completed. Results are stored in /mnt/data/lj752/data/MSc_training/scripting/data_output/valet




###########################################################################
PROCESSING ASSEMBLY: asm_0 (/mnt/data/lj752/data/MSc_training/scripting/data_output/medaka/consensus.fasta)
###########################################################################
---------------------------------------------------------------------------
STEP:	 FILTERING ASSEMBLY CONTIGS LESS THAN 1000 BPs
RESULTS:	 /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/filtered_assembly.fasta
---------------------------------------------------------------------------
STEP:	 ALIGNING READS
COMMAND:	 bowtie2-build /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/filtered_assembly.fasta /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/indexes/temp_vx4huh6c
COMMAND:	 bowtie2 -a -x /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/indexes/temp_vx4huh6c -q -U /mnt/data/lj752/data/MSc_training/scripting/fastq_72.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_1.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_79.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_2.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_34.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_78.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_12.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_73.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_50.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_61.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_69.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_86.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_41.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_23.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_107.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_53.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_14.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_38.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_85.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_81.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_74.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_42.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_58.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_35.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_40.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_100.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_83.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_9.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_15.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_10.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_68.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_59.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_19.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_102.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_64.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_101.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_89.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_26.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_54.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_92.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_63.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_18.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_37.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_84.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_4.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_77.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_98.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_91.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_28.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_93.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_87.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_3.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_11.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_90.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_8.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_67.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_49.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_44.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_52.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_109.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_25.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_99.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_30.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_71.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_80.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_56.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_76.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_7.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_43.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_65.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_45.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_66.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_105.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_60.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_36.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_6.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_97.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_82.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_22.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_5.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_94.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_24.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_31.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_17.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_104.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_51.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_75.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_0.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_57.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_70.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_48.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_20.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_62.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_29.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_46.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_16.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_55.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_103.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_27.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_21.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_88.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_13.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_106.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_47.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_108.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_96.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_39.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_33.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_95.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_32.fastq --very-sensitive -a --reorder -p 8 --un /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/unaligned_reads/unaligned.reads -S /mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/sam/library.sam
Command '['bowtie2', '-a', '-x', '/mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/indexes/temp_vx4huh6c', '-q', '-U', '/mnt/data/lj752/data/MSc_training/scripting/fastq_72.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_1.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_79.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_2.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_34.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_78.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_12.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_73.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_50.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_61.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_69.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_86.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_41.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_23.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_107.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_53.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_14.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_38.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_85.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_81.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_74.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_42.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_58.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_35.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_40.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_100.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_83.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_9.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_15.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_10.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_68.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_59.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_19.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_102.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_64.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_101.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_89.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_26.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_54.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_92.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_63.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_18.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_37.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_84.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_4.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_77.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_98.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_91.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_28.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_93.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_87.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_3.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_11.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_90.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_8.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_67.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_49.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_44.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_52.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_109.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_25.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_99.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_30.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_71.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_80.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_56.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_76.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_7.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_43.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_65.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_45.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_66.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_105.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_60.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_36.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_6.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_97.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_82.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_22.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_5.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_94.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_24.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_31.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_17.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_104.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_51.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_75.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_0.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_57.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_70.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_48.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_20.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_62.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_29.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_46.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_16.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_55.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_103.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_27.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_21.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_88.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_13.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_106.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_47.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_108.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_96.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_39.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_33.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_95.fastq,/mnt/data/lj752/data/MSc_training/scripting/fastq_32.fastq', '--very-sensitive', '-a', '--reorder', '-p', '8', '--un', '/mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/unaligned_reads/unaligned.reads', '-S', '/mnt/data/lj752/data/MSc_training/scripting/data_output/valet/asm_0/sam/library.sam']' returned non-zero exit status 137.




import pandas as pd
import sys

def vcf_to_df(vcf_files):
    """
    Convert a list of VCF files to a DataFrame.
    """
    try:
        # Initialize an empty list to store the DataFrames
        dfs = []

        # Iterate over each VCF file in the list
        for vcf_file in vcf_files:
            # Read the VCF file into a DataFrame
            df = pd.read_csv(vcf_file, sep='\t', comment='#', header=None)

            # Append the DataFrame to the list
            dfs.append(df)

        # Concatenate the list of DataFrames
        vcf_df = pd.concat(dfs, ignore_index=True)

        # Drop the duplicate columns
        vcf_df = vcf_df.loc[:, ~vcf_df.columns.duplicated()]

        # Rename the columns to match the original VCF file
        vcf_df.columns = vcf_df.columns.map(lambda x: x.split('_')[1] if '_' in x else x)

        # Return the concatenated DataFrame
        return vcf_df

    except Exception as e:
        # Print the error message and exit
        print(f"Error: {e}")
        sys.exit(1)
